# 마진 계산기 앱 기획서

## 1. 앱 개요

### 1.1 앱 명칭
"스마트 마진 계산기" (Smart Margin Calculator)

### 1.2 앱 목적
온라인 판매자들이 상품의 실질적인 마진율과 수익성을 쉽고 정확하게 계산할 수 있도록 도와주는 모바일/웹 애플리케이션입니다. 엑셀 계산식을 기반으로 하되, 더 직관적이고 사용하기 쉬운 인터페이스를 제공합니다. 판매자 커뮤니티에 기여하기 위해 완전 무료로 제공됩니다.

### 1.3 주요 타겟 사용자
- 쿠팡, 네이버스마트스토어 등 온라인 마켓플레이스 판매자
- 이커머스 창업자 및 MD
- 상품 가격 결정권자
- 온라인 마케팅 담당자

## 2. 핵심 기능

### 2.1 기본 마진 계산기
- **적정원가 계산**: 판매가, 수수료율, 물류비를 입력하면 적정 원가 자동 계산
- **국내사입 마진 계산**: 판매가, 원가, 수수료, 물류비, 반품률 기반 실제 마진 계산
- **해외수입 마진 계산**: 해외 원가를 입력하면 환율을 적용하여 원화 기준 마진 계산
- **결과 시각화**: 원가, 수수료, 물류비, 마진 등의 비중을 원형 그래프로 표시

### 2.2 카테고리별 수수료율 데이터베이스
- **마켓별 수수료 정보**: 쿠팡, 네이버, 11번가 등 주요 마켓의 수수료율 DB 탑재
- **카테고리 선택 기능**: 상품 카테고리 선택 시 해당 수수료율 자동 적용
- **정기 업데이트**: 마켓의 수수료 정책 변경 시 자동 업데이트

### 2.3 할인쿠폰 ROAS 계산기
- **쿠폰 효과 시뮬레이션**: 할인쿠폰 적용 시 실제 마진과 수익성 계산
- **제로마진 광고비 계산**: 손익분기점에서 집행 가능한 광고비 산출
- **광고 효율 지표**: ROAS(Return On Advertising Spend) 자동 계산

### 2.4 가격 전략 시뮬레이터
- **시나리오 비교**: 다양한 가격대와 할인 전략의 수익성 비교 기능
- **경쟁사 가격 분석**: 경쟁사 가격 입력 시 마진 차이 비교
- **최적 가격 추천**: 목표 마진율 입력 시 최적 판매가 추천

## 3. 사용자 인터페이스 설계

### 3.1 메인 화면
- 간결하고 직관적인 UI로 주요 기능에 빠르게 접근 가능
- 4개의 주요 기능 카드 표시: 기본 마진 계산, 카테고리별 수수료, 쿠폰 ROAS 계산, 가격 전략
- 최근 계산 기록 및 즐겨찾기 상품 표시

### 3.2 기본 마진 계산 화면
- 입력 필드: 판매가, 원가, 카테고리(수수료율), 물류비, 반품률 등
- 고정 비용과 변동 비용 구분 입력 가능
- 계산 결과: 수익액, 마진율, 손익분기점 등을 시각적으로 표시
- 결과 저장 및 공유 기능

### 3.3 카테고리별 수수료 화면
- 마켓 선택 드롭다운(쿠팡, 네이버, 11번가 등)
- 계층형 카테고리 선택 UI(대분류→중분류→소분류)
- 선택 카테고리의 수수료율 및 정책 정보 표시
- 마이 카테고리 등록 기능(자주 사용하는 카테고리 저장)

### 3.4 할인쿠폰 ROAS 계산 화면
- 입력 필드: 제품원가, 판매가격, 할인쿠폰 금액, 수수료율, 반품률 등
- 광고비 시뮬레이션 슬라이더: 광고비 조정에 따른 ROAS 변화 시각화
- 손익분기점 표시 및 제로마진 광고비 자동 계산
- 다양한 할인율 시나리오 비교 테이블

### 3.5 가격 전략 시뮬레이터 화면
- 경쟁사 가격 비교 입력 테이블
- 목표 마진율 설정 및 최적 가격 추천
- 다양한 가격대별 예상 수익 그래프
- 가격 변동에 따른 민감도 분석

## 4. 기술 명세

### 4.1 개발 플랫폼
- **웹 애플리케이션**: 반응형 디자인으로 모바일 및 데스크톱 모두 지원
- **모바일 앱**: iOS 및 Android 플러터 앱

### 4.2 백엔드 시스템
- 클라우드 기반 서버리스 아키텍처
- 사용자 데이터 및 계산 기록 저장을 위한 데이터베이스
- 마켓별 수수료 정보 정기 업데이트 시스템

### 4.3 데이터 처리
- 모든 계산식은 클라이언트 사이드에서 처리(오프라인 사용 가능)
- 복잡한 시뮬레이션은 서버 사이드에서 처리
- 사용자 데이터 암호화 및 보안 처리

### 4.4 확장성
- API 연동을 통한 마켓 데이터 자동 수집
- 엑셀 파일 임포트/익스포트 기능
- 다국어 지원(한국어, 영어, 중국어 등)

## 5. 사용자 시나리오

### 5.1 신규 상품 마진 계산
1. 사용자가 메인 화면에서 "기본 마진 계산" 선택
2. 판매 예정 상품의 카테고리 선택(자동으로 해당 수수료율 적용)
3. 예상 판매가와 원가, 물류비 등 입력
4. 계산 버튼 클릭하여 예상 마진율과 수익 확인
5. 필요시 가격 조정 후 재계산
6. 결과를 저장하거나 동료에게 공유

### 5.2 할인 프로모션 효과 분석
1. 사용자가 "할인쿠폰 ROAS 계산기" 선택
2. 기존 상품 정보 불러오기 또는 신규 입력
3. 계획 중인 할인쿠폰 금액 입력
4. 계산 결과로 할인 후 실제 마진과 손익분기점 확인
5. 제로마진 광고비 확인 및 광고 집행 계획 수립
6. 여러 할인 시나리오를 비교하여 최적 프로모션 전략 결정

### 5.3 최적 가격 전략 도출
1. 사용자가 "가격 전략 시뮬레이터" 선택
2. 상품 기본 정보와 원가 구조 입력
3. 경쟁사 가격 정보 입력
4. 목표 마진율 설정
5. 시뮬레이션 실행하여 다양한 가격대별 예상 수익 확인
6. 최적 가격점 선택 및 전략 수립

## 6. UI/UX 세부 계획

### 6.1 디자인 시스템
- **색상 팔레트**: 전문적이고 신뢰감을 주는 파란색 계열을 메인 컬러로 사용, 강조색으로 오렌지 계열 사용
- **타이포그래피**: 가독성 높은 Noto Sans KR(한글), Roboto(영문) 서체 사용
- **아이콘**: 직관적인 의미 전달을 위한 Material Design 아이콘 세트 활용
- **그리드 시스템**: 12열 그리드로 모든 디바이스에서 일관된 레이아웃 제공

### 6.2 반응형 디자인 전략
- **모바일 우선(Mobile First)**: 모바일 레이아웃을 기본으로 설계 후 태블릿, 데스크톱으로 확장
- **브레이크포인트**: 
  - 모바일: 320px-767px
  - 태블릿: 768px-1023px
  - 데스크톱: 1024px 이상
- **터치 영역**: 모바일 환경 최적화를 위해 모든 터치 영역 최소 44px × 44px로 설계

### 6.3 사용자 경험 최적화
- **입력 폼 자동완성**: 자주 사용하는 값 자동완성 기능
- **계산 즉시 반영**: 입력값 변경 시 실시간으로 결과 업데이트
- **비교 테이블**: 여러 시나리오를 한눈에 비교할 수 있는 테이블 뷰
- **시각화 도구**: 그래프와 차트를 통한 직관적인 결과 표시
- **마켓별 프리셋**: 주요 온라인 마켓 별 기본 설정값 제공 (수수료, 물류비 등)

### 6.4 접근성 고려사항
- WCAG 2.1 AA 수준 준수
- 스크린 리더 호환성
- 키보드 네비게이션 지원
- 고대비 모드 지원

### 6.5 인터랙션 디자인
- 부드러운 애니메이션 효과로 상태 변화 시각화
- 드래그 앤 드롭으로 쉬운 데이터 입력
- 인터랙티브 슬라이더로 값 범위 조정
- 툴팁과 가이드로 복잡한 개념 설명

## 7. 앱 개선 방향 및 실제 마진 계산기 구현 계획

현재 앱은 기본적인 UI 구조만 갖추고 하드코딩된 데이터를 표시하는 단계입니다. 실제 사용 가능한 마진 계산기로 개선하기 위한 구체적인 작업 계획은 다음과 같습니다.

### 7.1 핵심 계산 로직 구현

#### 7.1.1 엑셀 계산식 Flutter 코드 변환
- **적정원가 계산 로직**: `FLOOR(판매가*(1-수수료율/100-물류비/판매가)*(1-40/100),-2)`를 Flutter에서 구현
  ```dart
  double calculateOptimalCost(double sellingPrice, double commissionRate, double logisticsFee) {
    double netRevenue = sellingPrice * (1 - commissionRate/100 - logisticsFee/sellingPrice);
    double optimalCost = netRevenue * (1 - 40/100);
    return (optimalCost / 100).floor() * 100;
  }
  ```

- **반품 재입고비 계산**: 판매가격에 따른 차등 적용 로직 구현
  ```dart
  double calculateRestockingFee(double sellingPrice) {
    if (sellingPrice < 5000) return 300;
    else if (sellingPrice < 10000) return 400;
    else if (sellingPrice < 15000) return 600;
    else if (sellingPrice < 20000) return 800;
    else return 1000;
  }
  ```

- **국내사입 마진 계산**: `판매가-판매가*수수료율/100-물류비-원가-반품비용*반품률/100` 구현
  ```dart
  double calculateDomesticMargin(double sellingPrice, double commissionRate, 
                               double logisticsFee, double cost, double returnRate, double returnFee) {
    double commission = sellingPrice * commissionRate / 100;
    double returnCost = returnFee * returnRate / 100;
    return sellingPrice - commission - logisticsFee - cost - returnCost;
  }
  ```

- **해외수입 원가 환산**: `해외원가*환율` 계산 및 환율 설정 기능 구현
  ```dart
  double calculateForeignCost(double foreignCost, double exchangeRate) {
    return foreignCost * exchangeRate;
  }
  ```

#### 7.1.2 데이터 모델 확장
- 기존 `SpreadsheetData` 클래스를 확장하여 계산에 필요한 추가 속성 구현
- `FeeCategory` 클래스 추가하여 카테고리별 수수료율 데이터 구조화
- `CouponROAS` 클래스 구현하여 쿠폰 효과 계산 모델 구현

### 7.2 사용자 입력 기능 구현

#### 7.2.1 데이터 입력 화면 개발
- 판매가, 원가, 카테고리 등 기본 정보 입력 폼 구현
- 드롭다운, 숫자 입력, 슬라이더 등 최적화된 입력 컴포넌트 개발
- 입력값 유효성 검증 및 포맷팅 기능 구현

#### 7.2.2 StatefulWidget으로 전환
- 현재 `StatelessWidget`인 `SpreadsheetView`를 `StatefulWidget`으로 변경
- 사용자 입력을 상태로 관리하고 입력 변화에 따른 실시간 계산 구현
  ```dart
  class CalculatorView extends StatefulWidget {
    @override
    _CalculatorViewState createState() => _CalculatorViewState();
  }

  class _CalculatorViewState extends State<CalculatorView> {
    // 사용자 입력 상태 관리
    double salesPrice = 0.0;
    double commissionRate = 0.0;
    double logisticsFee = 0.0;
    // ...
    
    // 계산 결과
    double properCost = 0.0;
    double domesticMargin = 0.0;
    // ...
    
    // 입력 변경 시 계산 함수
    void recalculate() {
      setState(() {
        properCost = calculateOptimalCost(salesPrice, commissionRate, logisticsFee);
        // 다른 필드도 계산
      });
    }
    
    // UI 구현...
  }
  ```

### 7.3 카테고리별 수수료율 데이터베이스 구현

#### 7.3.1 수수료율 데이터 관리
- `fee_database.dart` 파일 생성하여 카테고리별 수수료율 데이터 구현
- 대/중/소분류 계층 구조의 카테고리 시스템 구현
- 엑셀 파일의 '로켓그로스 수수료율' 시트 데이터 마이그레이션

#### 7.3.2 카테고리 선택 UI 구현
- 검색 가능한 카테고리 드롭다운 컴포넌트 개발
- 계층형 카테고리 탐색 UI 구현
- 선택된 카테고리의 수수료율 자동 적용 기능

### 7.4 할인쿠폰 ROAS 계산기 구현

#### 7.4.1 쿠폰 효과 계산 화면 개발
- 할인쿠폰 금액 입력과 효과 시뮬레이션 UI 구현
- 순수익, 마진률, 제로마진 광고비 실시간 계산 기능 구현

#### 7.4.2 ROAS 시각화 컴포넌트
- 광고 효율 지표를 직관적으로 표시하는 게이지 및 차트 구현
- 손익분기점 표시 및 최적 광고비 추천 기능 개발

### 7.5 데이터 저장 및 공유 기능

#### 7.5.1 로컬 데이터 저장
- `shared_preferences` 또는 `sqflite` 패키지를 활용한 데이터 영구 저장
- 계산 기록과 자주 사용하는 상품 정보 저장 기능

#### 7.5.2 데이터 공유 기능
- 계산 결과를 텍스트, 이미지, 또는 CSV 형식으로 내보내기 기능
- 소셜 미디어 및 메신저 앱 공유 통합

### 7.6 UI/UX 고도화

#### 7.6.1 데이터 시각화 개선
- `fl_chart` 또는 `syncfusion_flutter_charts` 패키지를 활용한 그래프 구현
- 원형 차트로 비용 구성 비율 시각화
- 마진 변화 추이를 선 그래프로 표시

#### 7.6.2 반응형 UI 완성
- 다양한 화면 크기에 최적화된 레이아웃 구현
- 태블릿과 데스크톱에서 분할 화면 지원

### 7.7 테스트 및 최적화

#### 7.7.1 단위 테스트 작성
- 핵심 계산 함수에 대한 단위 테스트 구현
- 다양한 입력값 시나리오에 대한 검증 테스트

#### 7.7.2 성능 최적화
- 복잡한 계산 로직의 성능 최적화
- UI 렌더링 성능 개선

### 7.8 배포 및 모니터링

#### 7.8.1 앱 배포
- Google Play와 App Store에 앱 등록
- 웹 버전 배포를 위한 Firebase Hosting 설정

#### 7.8.2 사용자 피드백 수집
- 인앱 피드백 시스템 구현
- 앱 사용 분석을 위한 Firebase Analytics 통합

이러한 개선 작업을 통해 현재의 기본 UI 구조를 가진 앱을 실제 마진 계산이 가능한 완전한 기능의 앱으로 발전시킬 수 있습니다.